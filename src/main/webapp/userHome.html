<!DOCTYPE html>
<html lang="zh-CN">

<!--  head start -->
<head>
    <meta http-equiv="content-type" content="text/html" charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>个人主页</title>
    <link href="static/css/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/font-awesome/font-awesome.min.css" rel="stylesheet">
    <link href="static/css/toastr/toastr.min.css" rel="stylesheet">
    <link href="static/css/animate/animate.min.css" rel="stylesheet">
    <link href="static/css/jqcloud/jqcloud.css" rel="stylesheet">
    <link href="static/css/theme.css" rel="stylesheet">
    <link href="static/css/responsive.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="static/js/html5shiv/html5shiv.min.js"></script>
    <script src="static/js/respond/respond.min.js"></script>
    <![endif]-->
    <link rel="shortcut icon" href="static/img/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="static/img/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="static/img/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="static/img/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="static/img/ico/apple-touch-icon-57-precomposed.png">
</head>
<!--  head end -->

<body>
    <!-- 导航栏 start -->
    <header id="header">
        <div class="navbar" role="banner">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">英语学习</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="./index.html">
                        <h1><img src="static/img/logo.png" alt="logo"></h1>
                    </a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li class="dropdown"><a href="index.html">首页</a></li>
                        <li class="dropdown"><a href="video.html">视频浏览</a></li>
                        <li class="dropdown"><a href="word.html">单词背诵</a></li>
                        <li class="dropdown"><a href="articleList.html">文章阅读</a></li>
                        <li class="dropdown"><a href="about.html">关于我们</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>
    <!-- 导航栏 end -->

    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <h1 class="title">用户主页</h1><hr/>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-3 text-center padding wow fadeInDownBig" data-wow-duration="1000ms" data-wow-delay="300ms">
                <div class="single-service">
                    <a id="collectWordHref" href="javascript:void(0);">
                        <div class="wow scaleIn" data-wow-duration="500ms" data-wow-delay="300ms">
                            <img src="static/img/home/icon01.jpg" alt="">
                        </div>
                        <h2>收藏单词</h2>
                    </a>
                    <div class="text-center wow fadeIn" data-wow-duration="1000ms" data-wow-delay="300ms">
                        <h1 class="bold wordCollectionNum" data-to="1" data-speed="5000" data-from="0"></h1>
                    </div>
                </div>
            </div>

            <div class="col-sm-3 text-center padding wow fadeInDownBig" data-wow-duration="1000ms" data-wow-delay="600ms">
                <div class="single-service">
                    <a id="recitedWordHref" href="javascript:void(0);">
                        <div class="wow scaleIn" data-wow-duration="500ms" data-wow-delay="600ms">
                            <img src="static/img/home/icon02.jpg" alt="">
                        </div>
                        <h2>已背诵单词</h2>
                    </a>
                    <div class="text-center wow fadeIn" data-wow-duration="1000ms" data-wow-delay="300ms">
                        <h1 class="bold wordRecitedNum" data-to="1" data-speed="5000" data-from="0"></h1>
                    </div>
                </div>
            </div>
            <div class="col-sm-3 text-center padding wow fadeInDownBig" data-wow-duration="1000ms" data-wow-delay="900ms">
                <div class="single-service">
                    <a id="submitArticleHref" href="javascript:void(0)">
                        <div class="wow scaleIn" data-wow-duration="500ms" data-wow-delay="900ms">
                            <img src="static/img/home/icon03.jpg" alt="">
                        </div>
                        <h2>发表文章</h2>
                    </a>
                    <div class="text-center wow fadeIn" data-wow-duration="1000ms" data-wow-delay="300ms">
                        <h1 class="bold articleSubmitNum" data-to="1" data-speed="5000" data-from="0"></h1>
                    </div>
                </div>
            </div>
            <div class="col-sm-3 text-center padding wow fadeInDownBig" data-wow-duration="1000ms" data-wow-delay="900ms">
                <div class="single-service">
                    <a id="collectArticleHref" href="javascript:void(0);">
                        <div class="wow scaleIn" data-wow-duration="500ms" data-wow-delay="900ms">
                            <img src="static/img/home/icon03.jpg" alt="">
                        </div>
                        <h2>收藏文章</h2>
                    </a>
                    <div class="text-center wow fadeIn" data-wow-duration="1000ms" data-wow-delay="300ms">
                        <h1 class="bold articleCollectionNum" data-to="1" data-speed="5000" data-from="0"></h1>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-10 col-md-offset-1 col-sm-12">
                <hr/>
                <h2 style="margin: 20px">prefer keywords</h2>
                <div id="cloud" style="height: 250px"></div>
            </div>
        </div>

        <div class="row">
            <hr/>
            <div class="col-md-6 col-md-offset-1 col-sm-12">
                <h3>基本信息</h3><hr/>
                <div class="form-horizontal">
                    <div class="form-group">
                        <label for="profile_username" class="col-md-3 col-md-3 control-label">username</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="text" id="profile_username" class="form-control input-lg" readonly="readonly"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profile_email" class="col-md-3 col-md-3 control-label">e-mail</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="email" id="profile_email" class="form-control input-lg" readonly="readonly"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profile_phone_number" class="col-md-3 col-md-3 control-label">phone number</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="number" id="profile_phone_number" class="form-control input-lg" readonly="readonly"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profile_birthday" class="col-md-3 col-md-3 control-label">birthday</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="date" id="profile_birthday" class="form-control input-lg" readonly="readonly"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profile_qq_number" class="col-md-3 col-md-3 control-label">QQ number</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="number" id="profile_qq_number" class="form-control input-lg" readonly="readonly"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profile_nickname" class="col-md-3 col-md-3 control-label">nickname</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="text" id="profile_nickname" class="form-control input-lg" readonly="readonly"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profile_level" class="col-md-3 col-md-3 control-label">level</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="text" id="profile_level" class="form-control input-lg" readonly="readonly"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profile_register" class="col-md-3 col-md-3 control-label">register time</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="date" id="profile_register" class="form-control input-lg" readonly="readonly"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- footer start -->
    <footer id="footer">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="copyright-text text-center">
                        <p>&copy; 嘤嘤嘤 2020. All Rights Reserved.</p>
                        <p>Designed by <a target="_blank" href="http://www.baidu.com">嘤嘤嘤</a></p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- footer end -->

</body>

<script type="text/javascript" src="static/js/jquery/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="static/js/bootstrap/bootstrap.min.js"></script>
<script type="text/javascript" src="static/js/wow/wow.min.js"></script>
<script type="text/javascript" src="static/js/jquery/jquery.md5.js"></script>
<script type="text/javascript" src="static/js/toastr/toastr.min.js"></script>
<script type="text/javascript" src="static/js/jquery/jquery.countTo.js"></script>
<script type="text/javascript" src="static/js/gmaps/gmaps.min.js"></script>
<script type="text/javascript" src="static/js/jqcloud/jqcloud-1.0.4.min.js"></script>
<script type="text/javascript" src="static/js/user.js"></script>
<script type="text/javascript" src="static/js/main.js"></script>
<script>
    new WOW().init();
    function count(options) {
        let $this = $(this);
        options = $.extend({}, options || {}, $this.data('countToOptions') || {});
        $this.countTo(options);
    }

    let user={};
    const param = getRequest();
    if(param["username"] !== undefined) {// 如果有参数，也就是说查看他人的主页
        user.username = param["username"];
    }
    getUser(user, function InIt() {// 获取用户信息之后的回调函数
        $(".title").text(user.username + "的个人主页");
        $.ajax({//获取单词背诵数
            url: "word/countRecite",
            type: "GET",
            data: {"username": user.username},
            success: function (data) {
                $(".wordRecitedNum").attr("data-to",data);
                $(".wordRecitedNum").each(count);
                $("#recitedWordHref").attr("href",'./wordRecite.html?num='+data+'&type=review');
            }
        });
        $.ajax({// 获取单词收藏数
            url: "word/countCollect",
            type: "GET",
            data: {"username": user.username},
            success: function (data) {
                $(".wordCollectionNum").attr("data-to",data);
                $(".wordCollectionNum").each(count);
                $("#collectWordHref").attr("href",'./wordRecite.html?num='+data+'&type=collect');
            }
        });
        $.ajax({// 获取文章提交数
            url: "article/countArticleByAuthor",
            type: "GET",
            data: {"username": user.username},
            success: function (data) {
                $(".articleSubmitNum").attr("data-to",data);
                $(".articleSubmitNum").each(count);
                $("#submitArticleHref").attr("href",'./articleList.html?type=own&username='+user.username);
            }
        });
        $.ajax({// 获取文章收藏数
            url: "article/countArticleByCollect",
            type: "GET",
            data: {"username": user.username},
            success: function (data) {
                $(".articleCollectionNum").attr("data-to",data);
                $(".articleCollectionNum").each(count);
                $("#collectArticleHref").attr("href",'./articleList.html?type=collect&username='+user.username);
            }
        });
        getKeyword(user.username,function (keywordList) {
            let array=[];
            for(let keyword of keywordList){
                array.push({"text":keyword.keyword,"weight":keyword.tfidf});
            }
            if(array.length === 0){
                $("#cloud").html("<h2>NULL</h2>");
                return;
            }
            // 加载标签云
            $("#cloud").jQCloud(array,{
                removeOverflowing: false
            });
        });

        // 基本信息加载
        $("#profile_username").val(user.username);
        $("#profile_email").val(user.email);
        $("#profile_phone_number").val(user.phoneNumber);
        let date=new Date(user.birthday);
        let year=String(date.getFullYear());
        while (year.length<4)year='0'+year;
        let month=String(date.getMonth());
        while (month.length < 2)month = '0' + month;
        let day=String(date.getDate());
        while (date.length < 2)day = '0' + day;
        $("#profile_birthday").val(year+"-"+month+"-"+day);
        $("#profile_qq_number").val(user.qqNumber);
        $("#profile_nickname").val(user.nickname);
        $("#profile_level").val(number2level[user.level]);
        date = new Date(user.registerTime);
        year=String(date.getFullYear());
        while (year.length<4)year='0'+year;
        month=String(date.getMonth());
        while (month.length < 2)month = '0' + month;
        day=String(date.getDate());
        while (date.length < 2)day = '0' + day;
        $("#profile_register").val(year+"-"+month+"-"+day);
    });
</script>
</html>